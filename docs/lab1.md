

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1: –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –±–ª–æ—á–Ω—ã–µ —à–∏—Ñ—Ä—ã

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
–¶–µ–ª—å—é —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞ –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–∏–±–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã –∏ —Å—Ö–µ–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è (padding), –∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ C++20 –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1.  **–ê–ª–≥–æ—Ä–∏—Ç–º—ã:** DES, TripleDES (3DES), DEAL.
2.  **–†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:** ECB, CBC, CTR, Random Delta.
3.  **–°—Ö–µ–º—ã –Ω–∞–±–∏–≤–∫–∏ (Padding):** PKCS#7, ANSI X9.23, ISO 10126, Zero Padding.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **Clean Architecture** –∏ **SOLID** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### 1. –ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ (Interfaces)
–Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤—è–∑–∞–Ω–æ –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã:
*   `IBlockCipher`: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ª—é–±–æ–≥–æ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–∞. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã `encryptBlock` –∏ `decryptBlock` –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–∞.
*   `ICipherMode`: –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **Strategy**. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ —Å–µ–±—è `IBlockCipher` –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å—Ü–µ–ø–ª—è—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º (CBC, ECB –∏ —Ç.–¥.).
*   `IPadding`: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –±–∞–π—Ç–æ–≤ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è.

### 2. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ (C++20)
*   **std::span**: –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –±—É—Ñ–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ (Zero-copy).
*   **std::execution::par**: –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è —Ü–∏–∫–ª–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–≤ —Ä–µ–∂–∏–º–∞—Ö ECB, CTR) –Ω–∞ –≤—Å–µ —è–¥—Ä–∞ CPU.
*   **RAII**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (–ø–∞–º—è—Ç—å—é, —Ñ–∞–π–ª–æ–≤—ã–º–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏) —á–µ—Ä–µ–∑ —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏ (`std::unique_ptr`).

---

## üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

### 1. DES (Data Encryption Standard)
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ –æ—Å–Ω–æ–≤–µ **–°–µ—Ç–∏ –§–µ–π—Å—Ç–µ–ª—è**.
*   **–ë–ª–æ–∫:** 64 –±–∏—Ç–∞ (8 –±–∞–π—Ç).
*   **–ö–ª—é—á:** 56 –±–∏—Ç (–≤–≤–æ–¥–∏—Ç—Å—è 64 –±–∏—Ç–∞, –∫–∞–∂–¥—ã–π 8-–π –±–∏—Ç ‚Äî –±–∏—Ç —á–µ—Ç–Ω–æ—Å—Ç–∏, –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è).
*   **–†–∞—É–Ω–¥—ã:** 16.

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Ä–∞—É–Ω–¥–∞:**
–í—Ö–æ–¥–Ω–æ–π –±–ª–æ–∫ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–≤–µ –ø–æ–ª–æ–≤–∏–Ω—ã: $L_{i-1}$ –∏ $R_{i-1}$.
$$L_i = R_{i-1}$$
$$R_i = L_{i-1} \oplus F(R_{i-1}, K_i)$$
–ì–¥–µ $K_i$ ‚Äî —Ä–∞—É–Ω–¥–æ–≤—ã–π –∫–ª—é—á (48 –±–∏—Ç), –∞ $F$ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –§–µ–π—Å—Ç–µ–ª—è, –≤–∫–ª—é—á–∞—é—â–∞—è:
1.  **Expansion (E):** –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ 32 –±–∏—Ç –¥–æ 48 –±–∏—Ç.
2.  **XOR:** –°–ª–æ–∂–µ–Ω–∏–µ —Å —Ä–∞—É–Ω–¥–æ–≤—ã–º –∫–ª—é—á–æ–º.
3.  **S-Boxes (Substitution):** –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–º–µ–Ω–∞ 48 –±–∏—Ç $\to$ 32 –±–∏—Ç–∞ (8 —Ç–∞–±–ª–∏—Ü $6 \to 4$). –≠—Ç–æ —Å–µ—Ä–¥—Ü–µ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ—Å—Ç–∏ DES.
4.  **Permutation (P):** –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏—Ç.

### 2. TripleDES (3DES)
–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ DES –∫ –ø–µ—Ä–µ–±–æ—Ä—É –∫–ª—é—á–∞ (–∏–∑-–∑–∞ –º–∞–ª–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ 56 –±–∏—Ç).
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–µ–∂–∏–º **EDE (Encrypt-Decrypt-Encrypt)** —Å —Ç—Ä–µ–º—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –∫–ª—é—á–∞–º–∏ ($K_1, K_2, K_3$):
$$C = E_{K3}(D_{K2}(E_{K1}(P)))$$
–î–ª—è –¥–µ—à–∏—Ñ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
$$P = D_{K1}(E_{K2}(D_{K3}(C)))$$
–≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –¥–ª–∏–Ω—É –∫–ª—é—á–∞ –¥–æ 112 –∏–ª–∏ 168 –±–∏—Ç (–∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫–∏ "–í—Å—Ç—Ä–µ—á–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ").

### 3. DEAL (Data Encryption Algorithm with Larger blocks)
–ë–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä —Å —Ä–∞–∑–º–µ—Ä–æ–º –±–ª–æ–∫–∞ **128 –±–∏—Ç**, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π DES –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—É–Ω–¥–∞.
*   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ç—å –§–µ–π—Å—Ç–µ–ª—è (–∫–∞–∫ –∏ DES), –Ω–æ –æ–ø–µ—Ä–∏—Ä—É–µ—Ç 128-–±–∏—Ç–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏.
*   –ë–ª–æ–∫ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –ª–µ–≤—É—é (64 –±–∏—Ç) –∏ –ø—Ä–∞–≤—É—é (64 –±–∏—Ç) —á–∞—Å—Ç–∏.
*   –í –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞—É–Ω–¥–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ $F$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º DES.
*   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 6 —Ä–∞—É–Ω–¥–æ–≤.

---

## üîÅ –†–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (Modes of Operation)

### ECB (Electronic Codebook)
–ö–∞–∂–¥—ã–π –±–ª–æ–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
$$C_i = E_K(P_i)$$
*   **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–µ–Ω —Å –ø–æ–º–æ—â—å—é `std::for_each(std::execution::par, ...)` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏.

### CBC (Cipher Block Chaining)
–ö–∞–∂–¥—ã–π –±–ª–æ–∫ –ø–µ—Ä–µ–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º XOR-–∏—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º.
$$C_i = E_K(P_i \oplus C_{i-1})$$, –≥–¥–µ $C_0 = IV$ (–í–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏).
*   **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ (–Ω–µ–ª—å–∑—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å), –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ.

### CTR (Counter Mode)
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä –≤ –ø–æ—Ç–æ–∫–æ–≤—ã–π. –®–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ (Nonce + Counter).
$$K_i = E_K(Nonce || Counter_i)$$
$$C_i = P_i \oplus K_i$$
*   **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—Å—è –∏ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∏ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –ù–µ —Ç—Ä–µ–±—É–µ—Ç Padding.

### Random Delta (RD)
–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è —Å –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é ($\Delta$), –∑–∞–≤–∏—Å—è—â–µ–π –æ—Ç –∫–ª—é—á–∞/IV.
$$C_i = E_K(P_i \oplus \Delta_i)$$
–ì–¥–µ $\Delta_i$ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è PRNG (–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –í–∏—Ö—Ä—å –ú–µ—Ä—Å–µ–Ω–Ω–∞ `std::mt19937`, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π IV).

---

## üõ† –°–±–æ—Ä–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   Linux / macOS
*   CMake 3.20+
*   –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++20 (GCC 10+, Clang 11+)
*   –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Intel TBB (–¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞): `sudo apt install libtbb-dev`

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
1.  **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
    ```bash
    ./scripts/build.sh
    ```
2.  **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:**
    ```bash
    ./scripts/run_tests.sh
    ```
    *–ü—Ä–æ–≤–µ—Ä—è–µ—Ç 39 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (–ê–ª–≥–æ—Ä–∏—Ç–º—ã √ó –†–µ–∂–∏–º—ã √ó –ü–∞–¥–¥–∏–Ω–≥–∏).*

3.  **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
    ```bash
    ./bin/lab1 <MODE> <ALGO> <PADDING> <KEY> <IN_FILE> <OUT_FILE> [enc|dec]
    ```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é DES –≤ —Ä–µ–∂–∏–º–µ CBC —Å PKCS7:**
```bash
./bin/lab1 CBC DES PKCS7 my_secret_key data.txt data.enc enc
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (3DES + ECB + ANSI):**
```bash
./bin/lab1 ECB 3DES ANSI another_key data.enc result.txt dec
```

**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã (—Å –∞–Ω–∏–º–∞—Ü–∏–µ–π):**
```bash
./scripts/run_lab1.sh
```

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```text
include/crypto/
‚îú‚îÄ‚îÄ interfaces/         # –ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ (IBlockCipher, ICipherMode, IPadding)
‚îú‚îÄ‚îÄ symmetric/          # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (DES, TripleDES, DEAL)
‚îú‚îÄ‚îÄ modes/              # –†–µ–∂–∏–º—ã (ECB, CBC, CTR, RandomDelta)
‚îú‚îÄ‚îÄ padding/            # –°—Ö–µ–º—ã –Ω–∞–±–∏–≤–∫–∏ (PKCS7, ANSI, ISO, Zeros)
‚îî‚îÄ‚îÄ utils/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã (BitUtils, FileProcessor)
```